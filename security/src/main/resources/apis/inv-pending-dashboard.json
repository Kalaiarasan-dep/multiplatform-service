{
  "select": {

    "default_PARTNER": {
      "query": "WITH dashboard AS (SELECT  SUM(CASE WHEN ir.status_id IN (12) THEN COALESCE(COALESCE(total_amount, 0) + COALESCE(igst_rate, 0) + COALESCE(cgst_rate, 0) + COALESCE(sgst_rate, 0), 0) END) AS Unapproved_invoice_onhold_amount, SUM(CASE WHEN ir.status_id IN (12) THEN 1 END) AS Unapproved_invoice_onhold_count, SUM(CASE WHEN ir.status_id IN (11) THEN COALESCE(COALESCE(total_amount, 0) + COALESCE(igst_rate, 0) + COALESCE(cgst_rate, 0) + COALESCE(sgst_rate, 0), 0) END) AS Unapproved_invoice_rejected_amount, SUM(CASE WHEN ir.status_id IN (11) THEN 1 END) AS Unapproved_invoice_rejected_count,\n       (\n            SELECT SUM(COALESCE(total_amount, 0) + COALESCE(igst_rate, 0) + COALESCE(cgst_rate, 0) + COALESCE(sgst_rate, 0))\n            FROM invoice_request irs\n            WHERE DATEDIFF(CURDATE(), DATE(irs.create_dt)) <= 30\n              AND irs.status_id = 14\n               and partner_id in \n(SELECT partner_id FROM partner_has_user where user_id=u.id)\n        ) AS pending_submission_amount_less_than_30,\n        (\n            SELECT COUNT(*)\n            FROM invoice_request irs\n            WHERE DATEDIFF(CURDATE(), DATE(irs.create_dt)) <= 30\n              AND irs.status_id = 14\n              and partner_id in \n(SELECT partner_id FROM partner_has_user where user_id=u.id)\n        ) AS pending_submission_less_than_30_count,\n        (\n            SELECT SUM(COALESCE(total_amount, 0) + COALESCE(igst_rate, 0) + COALESCE(cgst_rate, 0) + COALESCE(sgst_rate, 0))\n            FROM invoice_request irs\n            WHERE DATEDIFF(CURDATE(), DATE(irs.create_dt)) > 30\n              AND irs.status_id = 14\n              and partner_id in \n(SELECT partner_id FROM partner_has_user where user_id=u.id)\n        ) AS pending_submission_amount_more_than_30,\n        (\n            SELECT COUNT(*)\n            FROM invoice_request irs\n            WHERE DATEDIFF(CURDATE(), DATE(irs.create_dt)) > 30\n              AND irs.status_id = 14\n              and partner_id in \n(SELECT partner_id FROM partner_has_user where user_id=u.id)\n        ) AS pending_submission_more_than_30_count\n    FROM \n        invoice_request ir\n    INNER JOIN \n        `order` o ON o.invoice_request_id = ir.id\n    INNER JOIN \n        partner_has_user phu ON phu.partner_id = ir.partner_id\n    INNER JOIN \n        user u ON u.id = phu.user_id\n    WHERE \n        u.id = :userid\n)\nSELECT \n    JSON_OBJECT(\n       \n        'Unapproved_invoice_onhold_amount', IFNULL(Unapproved_invoice_onhold_amount, 0),\n        'Unapproved_invoice_onhold_count', IFNULL(Unapproved_invoice_onhold_count, 0),\n        'Unapproved_invoice_rejected_amount', IFNULL(Unapproved_invoice_rejected_amount, 0),\n        'Unapproved_invoice_rejected_count', IFNULL(Unapproved_invoice_rejected_count, 0),\n        'Pending_invoice_submissions', IFNULL(pending_submission_amount_more_than_30, 0) + IFNULL(pending_submission_amount_less_than_30, 0),\n        'unapproved_invoices_total', IFNULL(Unapproved_invoice_onhold_amount, 0) + IFNULL(Unapproved_invoice_rejected_amount, 0),\n        'pending_submission_amount_less_than_30', IFNULL(pending_submission_amount_less_than_30, 0),\n        'pending_submission_less_than_30_count', IFNULL(pending_submission_less_than_30_count, 0),\n        'pending_submission_amount_more_than_30', IFNULL(pending_submission_amount_more_than_30, 0),\n        'pending_submission_more_than_30_count', IFNULL(pending_submission_more_than_30_count, 0)\n    ) AS data\nFROM \n    dashboard",
      "postProcessor": "dashboardPostProcessor"
    },
    "suportRoleBasedQueries": true
  }
}